@inherits LayoutComponentBase
@implements IDisposable
@inject AiPanelState PanelState

<div class="cc-layout">
    <IconRailSidebar />
    <div class="cc-main @(PanelState.IsOpen ? "cc-main--ai-open" : "") @(PanelState.IsOpen && PanelState.IsWide ? "cc-main--ai-wide" : "")">
        <TopBar />
        <div class="cc-body">
            @Body
        </div>
        <StatusBar />
    </div>
</div>

<AiAssistantPanel />

<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">&#x1f5d9;</span>
</div>

@code {
    protected override void OnInitialized()
    {
        PanelState.OnChange += OnPanelChanged;
    }

    private void OnPanelChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        PanelState.OnChange -= OnPanelChanged;
    }
}
